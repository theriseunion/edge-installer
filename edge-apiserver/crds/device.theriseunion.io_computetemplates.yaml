apiVersion: apiextensions.k8s.io/v1
kind: CustomResourceDefinition
metadata:
  annotations:
    cert-manager.io/inject-ca-from: edge-system/edge-serving-cert
    controller-gen.kubebuilder.io/version: v0.16.1
  name: computetemplates.device.theriseunion.io
spec:
  group: device.theriseunion.io
  names:
    kind: ComputeTemplate
    listKind: ComputeTemplateList
    plural: computetemplates
    singular: computetemplate
  scope: Cluster
  versions:
  - additionalPrinterColumns:
    - jsonPath: .spec.manufacturer
      name: Manufacturer
      type: string
    - jsonPath: .spec.model
      name: Model
      type: string
    - jsonPath: .spec.deviceMemoryScaling
      name: MemoryScaling
      type: string
    - jsonPath: .spec.deviceCoreScaling
      name: CoreScaling
      type: string
    - jsonPath: .spec.deviceSplitCount
      name: SplitCount
      type: integer
    - jsonPath: .spec.computeSplitMode
      name: ComputeSplitMode
      type: string
    - jsonPath: .spec.computeSplitStrategy
      name: ComputeSplitStrategy
      type: string
    - jsonPath: .status.available
      name: Available
      type: boolean
    - jsonPath: .status.applyAllModel
      name: ApplyAllModel
      type: boolean
    - jsonPath: .status.updateTime
      name: UpdateTime
      type: date
    name: v1alpha1
    schema:
      openAPIV3Schema:
        description: ComputeTemplate is the Schema for the computetemplates API
        properties:
          apiVersion:
            description: |-
              APIVersion defines the versioned schema of this representation of an object.
              Servers should convert recognized schemas to the latest internal value, and
              may reject unrecognized values.
              More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#resources
            type: string
          kind:
            description: |-
              Kind is a string value representing the REST resource this object represents.
              Servers may infer this from the endpoint the client submits requests to.
              Cannot be updated.
              In CamelCase.
              More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#types-kinds
            type: string
          metadata:
            type: object
          spec:
            properties:
              computeSplitMode:
                default: hami-core
                description: ComputeSplitMode defines the compute split mode (e.g.,
                  "mig" means split into MIG devices)
                enum:
                - mig
                - hami-core
                - mps
                type: string
              computeSplitStrategy:
                description: ComputeSplitStrategy 算力切分策略，不同的切分模式可能有不同的的切分策略
                type: string
              description:
                description: Description is the description of the compute template.
                type: string
              deviceCoreScaling:
                default: "1.0"
                description: |-
                  DeviceCoreScaling defines the device core scaling factor (e.g., 2 means 2x)。 浮点数在CRD中被认为是危险类型，因此这里使用字符串表示。
                  Must be a positive number in string format (e.g., "1.5", "2.0")
                pattern: ^[0-9]+(\.[0-9]+)?$
                type: string
              deviceMemoryScaling:
                default: "1.0"
                description: |-
                  DeviceMemoryScaling defines the device memory scaling factor (e.g., 2 means 2x)。 浮点数在CRD中被认为是危险类型，因此这里使用字符串表示。
                  Must be a positive number in string format (e.g., "1.5", "2.0")
                pattern: ^[0-9]+(\.[0-9]+)?$
                type: string
              deviceSplitCount:
                default: 10
                description: |-
                  DeviceSplitCount defines the number of device splits (e.g., 2 means split into 2 devices)
                  需要和切分模式联动
                maximum: 20
                minimum: 1
                type: integer
              manufacturer:
                description: Manufacturer is the manufacturer of the compute template.
                type: string
              model:
                description: |-
                  Model is the model of the compute template.
                  如果存在theriseunion.io/model-scope: "all"标签，那么表示该模板适用于当前厂商的所有型号的显卡
                type: string
            required:
            - manufacturer
            - model
            type: object
          status:
            properties:
              appliedItems:
                description: AppliedItems 应用范围下的具体项
                items:
                  properties:
                    items:
                      description: |-
                        Items 作用域下的具体项
                        譬如Scope=node时，Items为节点名称列表，例如["node1", "node2"]
                        譬如Scope=device时，Items为显卡名称列表，例如["device1", "device2"]
                        譬如Scope=resourcePool时，Items为资源池名称列表，例如["resourcePool1", "resourcePool2"]
                      items:
                        type: string
                      type: array
                    scope:
                      description: Scope 作用域
                      type: string
                  required:
                  - items
                  - scope
                  type: object
                type: array
              applyAllModel:
                description: ApplyAllModel 表示当前模板是否适用于厂商所有型号的显卡
                type: boolean
              available:
                description: 当集群中存在这个厂商，型号的显卡时，这个模板才是可用的。
                type: boolean
              updateTime:
                description: UpdateTime 模板最后更新时间
                format: date-time
                type: string
            required:
            - available
            type: object
        type: object
    served: true
    storage: true
    subresources:
      status: {}
