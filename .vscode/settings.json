{
  // Helm-LS 配置
  "helm-ls": {
    "helm": {
      "path": "helm"
    },
    "yaml": {
      "schemas": {
        "https://raw.githubusercontent.com/mrjosh/helm-ls/main/schemas/values.schema.json": "**/values.yaml"
      },
      "validate": true,
      "format": {
        "enable": true
      }
    },
    "lint": {
      "enabled": false
    },
    "completion": {
      "enabled": true
    },
    // 增加超时时间，避免解析超时
    "timeout": 30000,
    // 禁用可能导致问题的功能
    "diagnostics": {
      "enable": true,
      "delay": 1000
    }
  },

  // 文件关联 - 让 VS Code 识别 Helm 模板
  "files.associations": {
    "**/templates/**/*.yaml": "helm",
    "**/templates/**/*.tpl": "helm",
    "**/Chart.yaml": "yaml",
    "**/values.yaml": "yaml",
    "**/.helmignore": "ignore"
  },

  // YAML 配置
  // 注意：schemaStore 在下面被禁用，避免与 helm-ls 冲突
  "yaml.schemas": {
    "https://raw.githubusercontent.com/mrjosh/helm-ls/main/schemas/values.schema.json": [
      "**/values.yaml",
      "**/Chart.yaml"
    ]
  },
  "yaml.customTags": [
    "!And scalar",
    "!If scalar",
    "!Not scalar",
    "!Equals scalar",
    "!Or scalar",
    "!FindInMap sequence",
    "!Base64 scalar",
    "!Cidr scalar",
    "!Ref scalar",
    "!Sub scalar",
    "!GetAtt scalar",
    "!GetAZs scalar",
    "!ImportValue scalar",
    "!Select sequence",
    "!Split sequence",
    "!Join sequence"
  ],

  // 编辑器配置
  "[helm]": {
    "editor.defaultFormatter": "ms-kubernetes-tools.vscode-kubernetes-tools",
    "editor.formatOnSave": true
  },
  "[yaml]": {
    "editor.defaultFormatter": "redhat.vscode-yaml",
    "editor.formatOnSave": true,
    "editor.tabSize": 2
  },

  // YAML 配置 - 优化以避免冲突
  "yaml.validate": true,
  "yaml.completion": true,
  "yaml.hover": true,
  // 禁用 YAML 扩展的某些功能，避免与 helm-ls 冲突
  "yaml.schemaStore.enable": false,
  "yaml.trace.server": "off",
  
  // 如果 helm-ls 仍有问题，可以尝试禁用 YAML 扩展的验证
  // "yaml.validate": false,
  
  // 编辑器行为配置
  "editor.quickSuggestions": {
    "strings": true
  },
  "editor.suggest.snippetsPreventQuickSuggestions": false
}
